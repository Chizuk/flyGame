<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="PracticeCss.css">
    <meta charset="utf-8" />
    <title>Gamedev Canvas Workshop</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="720" height="600"></canvas>

<script>
	var canvas = document.getElementById("myCanvas");//самолет игрока (начало)
	var ctx = canvas.getContext("2d");
	var paddleHeight = 30;
	var paddleWidth = 75;
	var paddleX = (canvas.width-paddleWidth)/2;
	var rightPressed = false;
	var leftPressed = false;
	var brickkHeight = 20;
	var brickkWidth = 50;
	document.addEventListener("keydown", keyDownHandler, false);
	document.addEventListener("keyup", keyUpHandler, false);
		function drawBrick() {
			ctx.beginPath();
			ctx.rect(paddleX, canvas.height-paddleHeight*2, brickkWidth, brickkHeight);
			ctx.fillStyle = "0095DD";
			ctx.fill();
			ctx.closePath();
		}
		function drawPlayer() {
			drawBrick();
			if(rightPressed) {
			paddleX += 5;}
			else if (leftPressed) {
			paddleX -= 5;}
			colision();
		}
		function colision(){
			if(paddleX<0){
				paddleX=0;
			}
			var RightCol=canvas.width-brickkWidth; 
			if (paddleX >RightCol){
				paddleX=canvas.width-brickkWidth;
			}		
		}
		function keyDownHandler (e) {
			if(e.keyCode == 39) {
			rightPressed = true;
			}
			else if (e.keyCode == 37) {
			leftPressed = true;
			}
		}
			function keyUpHandler (e) {
			if(e.keyCode == 39) {
			rightPressed = false;
			}
			else if (e.keyCode == 37) {
			leftPressed = false;
			}
		}//самолет игрока (конец)
		//keyCode: space- 32  up- 38 left- 37 right- 39 down- 40
//---------------------------- Выстрел игрока -----------------------------------------
		var bulletRadius = 5;// размеры снаряда(радиус шара)
		var BylletDY=2;
		var FireP=false;
		var Bull=0;
		document.addEventListener("keyup", PressFireUP, false);
		document.addEventListener("keydown", PressFireDOWN, false);
			//параметры для прорисовки пули игрока
		var NumderBull=10;//кол-во пуль 
		var bullArrX=[], bullArrY=[];//	масивы с координатами х и у 	
		var idBull=[];
		var Bullid;
		for(var i=0;i<NumderBull;i++){
			idBull[i]=0;
			bullArrY[i]=(canvas.height-paddleHeight*2)-bulletRadius;
		}
		

		
		function drawBulleStart(){
		
				for(var i=0;i<NumderBull;i++){
					if(idBull[i]==0){
						Bullid=i;
					}
				}
				idBull[Bullid]=1;
				bullArrX[Bullid]=(paddleX+paddleWidth/2);
		}
		
		function DestroyBull(){
			for(var i=0;i<NumderBull;i++){
				if(bullArrY[i]<-6){
					idBull[i]=0;
					bullArrY[i]=(canvas.height-paddleHeight*2)-bulletRadius;					
				}				
			}
		}
		
			
		function drawBullet(){
			for(var i=0;i<NumderBull;i++){
				if(idBull[i]== 1){
					ctx.beginPath();
					ctx.arc(bullArrX[i],bullArrY[i],bulletRadius,0,Math.PI*2);//X-отступ слева,Y- сверху 
					ctx.fillStyle="0095DD";
					ctx.fill();
					ctx.closePath;			
					bullArrY[i]-=BylletDY;		
					DestroyBull();
				}
			}
		}
		
		function PressFireUP (e) {
			if(e.keyCode == 32 || e.keyCode == 38) {
			FireP = true;
			drawBulleStart();
			}
		}
		
		function PressFireDOWN (e) {
			if(e.keyCode == 32 || e.keyCode == 38) {
			FireP = false;
			}
		}
//---------------------------------------------------------
//враги 
		var counter=0;//щетчик врагов
		var counterLive=0;//щетчик живых врагов
		var counterType=[0,0,0,0];//щетчик врагов разных тивов 
		
		function EnemyPilot(Type){
			this.Height=20;
			this.Width=50;
			this.typeE=Type;
			this.indent=80;
			this.Right;
			switch(Type){
				case 0: 					
					this.StartX=this.indent;
					this.Right=true;
					break;
				case 1:
					this.StartX=this.Width+this.indent*2;
					this.Right=true;
					break;
				case 2:
					this.StartX=(canvas.width-(this.Width+this.indent)*2);
					this.Right=false;
					break;
				case 3:
					this.StartX=canvas.width-(this.Width+this.indent);
					this.Right=false;
					break;			
			}
			this.StartY=0-this.Height;
			this.GoX=1;
			this.GoY=0.5;
			this.life=true;//проверка на то что самолет не уничтожен 
		}
		
		var EnemyPilots =[];
		var MaxEnemy=4;
		
		function EnemySpawn(){
			if(counterLive<MaxEnemy){
				if(counterType[0]<=counterType[1] && counterType[0]<=counterType[2] && counterType[0]<=counterType[3]){
					EnemyPilots[counter]=new EnemyPilot(0);
					counter+=1;
					counterType[0]+=1;
					counterLive+=1;
				}
				if(counterType[1]<counterType[0] && counterType[1]<=counterType[2] && counterType[1]<=counterType[3]){
					EnemyPilots[counter]=new EnemyPilot(1);
					counter+=1;
					counterLive+=1;
					counterType[1]+=1;
				}
				if(counterType[2]<counterType[0] && counterType[2]<counterType[1] && counterType[2]<=counterType[3]){
					EnemyPilots[counter]=new EnemyPilot(2);
					counter+=1;
					counterLive+=1;
					counterType[2]+=1;
				}
				if(counterType[3]<counterType[0] && counterType[3]<counterType[2] && counterType[3]<counterType[1]){
					EnemyPilots[counter]=new EnemyPilot(3);
					counter+=1;
					counterLive+=1;
					counterType[3]+=1;
				}				
			}
		}
		function EnemyDraw(){
			EnemySpawn();
			for(var i=0;i<counter;i++){
				if(EnemyPilots[i].life){
					ctx.beginPath();					
					ctx.rect(EnemyPilots[i].StartX, EnemyPilots[i].StartY, EnemyPilots[i].Width, EnemyPilots[i].Height);
					ctx.fillStyle = "0095DD";
					ctx.fill();
					ctx.closePath();	
					EnemyGo(i);
					//DestroyEnemy(i);
				}
			}	
		
		}
		var B;
		
		function EnemyGo(i){
			B=((canvas.width/2-EnemyPilots[i].Width)-5);
			switch (EnemyPilots[i].typeE){
				case 0:
					//if(){
						EnemyPilots[i].StartX+=EnemyPilots[i].GoX;
						EnemyPilots[i].StartY+=EnemyPilots[i].GoY;
						break;
					//}
				case 1:
					if(EnemyPilots[i].Right==false){
						EnemyPilots[i].StartX-=EnemyPilots[i].GoX;
						EnemyPilots[i].StartY+=EnemyPilots[i].GoY;
						if(EnemyPilots[i].StartX==EnemyPilots[i].indent){
							EnemyPilots[i].Right=true;
						}
						
						break;
					}
					if(EnemyPilots[i].Right==true){
						EnemyPilots[i].StartX+=EnemyPilots[i].GoX;
						EnemyPilots[i].StartY+=EnemyPilots[i].GoY;
						if(EnemyPilots[i].StartX>B){
							EnemyPilots[i].Right=false;
						}
						break;
					}
					
				case 2:
					
						EnemyPilots[i].StartX-=EnemyPilots[i].GoX;
						EnemyPilots[i].StartY+=EnemyPilots[i].GoY;
						break;
				case 3: 
						EnemyPilots[i].StartX-=EnemyPilots[i].GoX;
						EnemyPilots[i].StartY+=EnemyPilots[i].GoY;
						break;
			}
		}
		function DestroyEnemy(i){
		//	for(int j=0;j<)
		
		}
			
//---------------------------------------------------------
		function drawGame(){
		ctx.clearRect(0, 0, canvas.width, canvas.height);
			drawPlayer();//прорисовка игрока 
			drawBullet();//прорисовка выстрелов игрока		
			EnemyDraw();//прорисовка врага 
		}
		
		setInterval(drawGame, 10);

		
		</script>

		
</body>
</html>
